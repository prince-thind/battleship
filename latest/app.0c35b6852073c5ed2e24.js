(self.webpackChunkbattleship=self.webpackChunkbattleship||[]).push([[143],{143:()=>{window.cheat=function(){[...document.querySelector("#enemy-field").querySelectorAll(".enemy-hidden")].forEach((e=>e.classList.add("enemy-cheat")))}},39:(e,t,n)=>{"use strict";function r(){const e=[];for(let t=0;t<9;t++){const t=[];for(let e=0;e<9;e++)t.push(0);e.push(t)}return e}n.d(t,{M:()=>M});const o={ships:0,structures:[],enemyStrucutures:[],grid:r(),enemyGrid:r()};function s(){const e=Math.trunc(3*Math.random()+2),t=Array(16).fill(0);if(2*Math.random()>1)for(let n=0;n<e;n++)t[n]=1;else for(let n=0,r=0;n<e;n++,r+=4)t[r]=1;return t}const c=function(e){const t=[];for(let n=0;n<e;n++){const e=s();t.push(e)}return t};const i=function(){const e=document.querySelector("#selection-grid");o.structures=c(o.ships),o.enemyStrucutures=c(o.ships),function(e){for(let r=0;r<9;r++)for(let o=0;o<9;o++){const s=document.createElement("div");s.className="selection-element",s.id="E"+r+o,s.addEventListener("mouseenter",t),s.addEventListener("click",t),s.addEventListener("mouseleave",n),e.append(s)}function t(t){const n=t.target.id.slice(1),r=[];for(let t=0;t<4;t++)for(let o=0;o<4;o++){const s=e.querySelector("#E"+(+n[0]+t)+(+n[1]+o));r.push(s)}"click"==t.type?function(e){const t=function(e){let t=!0;return e.forEach(((e,n)=>{if(1==o.structures[0][n]){if(!e)return t=!1,t;1==o.grid[e.id[1]][e.id[2]]&&(t=!1)}})),t}(e);t&&(e.forEach(((e,t)=>{1==o.structures[0][t]&&(e.setAttribute("data-permanent","true"),o.grid[e.id[1]][e.id[2]]=1)})),o.structures.shift())}(r):function(e){e.forEach(((e,t)=>{1==o.structures[0][t]&&e&&e.classList.add("highlight")}))}(r),0==o.structures.length&&M()}function n(){[...e.children].forEach((e=>{e.getAttribute("data-permanent")||e.classList.remove("highlight")}))}}(e),function(){for(const e of o.enemyStrucutures){const t=""+Math.trunc(5*Math.random())+Math.trunc(5*Math.random()),n=[];for(let e=0;e<4;e++)for(let r=0;r<4;r++){const o=""+(+t[0]+e)+(+t[1]+r);n.push(o)}n.forEach(((t,n)=>{1==e[n]&&(o.enemyGrid[t[0]][t[1]]=1)}))}}()},u=[];let l=[];function a(e){const t=y.player[e[0]][e[1]];t.hit||t.empty||function(e){const t=[],n=function(e){const t=e[0],n=e[1];let r=Array(4).fill(null);return r[0]=+t-1+""+n,r[1]=+t+1+""+n,r[2]=+t+""+(+n-1),r[3]=+t+""+(+n+1),r=r.map((e=>e.length>2||e[0]>8||e[1]>8?null:e)),r}(e);for(let e of n){if(!e)break;y.player[e[0]][e[1]].hit||t.push(e[0]+""+e[1])}!function(e,t){for(const n of t)e.includes(n)||e.push(n)}(l,t)}(e),t.hit=1,u.push(e)}function d(){return Math.trunc(9*Math.random())+""+Math.trunc(9*Math.random())}function f(){const e=n(y.enemy),t=n(y.player);return e&&(y.winner="Player"),t&&(y.winner="Enemy"),e||t||null;function n(e){let t=!0;for(let n of e)for(let e of n)0==e.empty&&0==e.hit&&(t=!1);return t}}const h=function(e){if(y.winner)return void p();const t=e.target,[n,r]=t.getAttribute("data-tag").split(""),o=y.enemy[n][r].hit;y.enemy[n][r].hit=!0,f()||o||(0==l.length?a(function(){let e=d();for(;u.includes(e);)e=d();return e}()):a(l.pop()),f()),p()};function m(e){const t="player"==e?y.player:y.enemy;let n=0;for(const e of t)for(const t of e)t.hit||t.empty||n++;return n}const y={player:[],enemy:[],winner:null};function p(){const e=document.querySelector("#winner-screen"),t=document.querySelector("#player-field"),n=document.querySelector("#enemy-field");t.innerHTML="",n.innerHTML="",g(t,y.player),g(n,y.enemy,"enemy"),y.winner&&(function(e){[...e.querySelectorAll(".enemy-hidden")].forEach((e=>e.classList.remove("enemy-hidden")))}(n),function(e,t){e.classList.toggle("hidden");const n=e.querySelector("#winner-info"),r=e.querySelector("#reload");n.textContent=`${t} has Won!`,r.addEventListener("click",(e=>{e.preventDefault(),location.reload()}))}(e,y.winner)),function(){const e=document.querySelector("#player-chunks"),t=document.querySelector("#enemy-chunks"),n=m("player"),r=m("enemy");e.textContent=n,t.textContent=r}()}function g(e,t,n){for(let r=0;r<t.length;r++)for(let o=0;o<t[r].length;o++){const s=document.createElement("div");s.classList.add("field-element"),t[r][o].empty||(s.classList.add("ship-part"),t[r][o].hit&&s.classList.add("ship-hit")),t[r][o].hit&&t[r][o].empty&&s.classList.add("empty-hit"),"enemy"==n?(s.addEventListener("click",h),s.setAttribute("data-tag",r+""+o),0==t[r][o].empty&&s.classList.add("enemy-hidden")):s.setAttribute("data-player",r+""+o),e.append(s)}}function L(e){const t=function(e){const t=[];for(let e=0;e<9;e++){const e=[];for(let t=0;t<9;t++){const t={hit:!1,empty:!0};e.push(t)}t.push(e)}return t}();for(let n=0;n<9;n++)for(let r=0;r<9;r++)1==e[n][r]&&(t[n][r].empty=!1);return t}n(143);const S=document.querySelector("#ship-form"),E=document.querySelector("#start-menu"),q=document.querySelector("#deploy-menu"),v=document.querySelector("#main-game");function M(){var e;q.classList.toggle("hidden"),v.classList.toggle("hidden"),e=o,y.player=L(e.grid),y.enemy=L(e.enemyGrid),y.playerShips=e.ships,y.enemyShips=e.ships,p()}S.addEventListener("submit",(function(e){e.preventDefault();const t=e.target.ships.value;o.ships=t,E.classList.toggle("hidden"),q.classList.toggle("hidden"),i()}))}},e=>{e(e.s=39)}]);
//# sourceMappingURL=app.0c35b6852073c5ed2e24.js.map